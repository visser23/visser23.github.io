<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Plan your annual leave around school holidays. A simple, privacy-first tool for UK working parents.">
    <title>Work Leave Planner</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="apple-touch-icon" href="favicon.svg">
    <meta name="theme-color" content="#2D9D78">
    
    <!-- Fonts - Outfit for a modern, clean look -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="src/css/main.css">
    <link rel="stylesheet" href="src/css/calendar.css">
</head>
<body>
    <!-- Skip link for keyboard users -->
    <a href="#calendar-container" class="skip-link">Skip to calendar</a>
    
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-brand">
                <h1 class="app-title">Work Leave Planner</h1>
                <p class="app-tagline">Plan your year, protect your time</p>
            </div>
            <div class="header-controls">
                <a href="https://paypal.me/viss23/5GBP" target="_blank" rel="noopener noreferrer" class="btn btn-coffee" id="coffee-btn" title="Buy me a coffee">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M18 8h1a4 4 0 0 1 0 8h-1"></path>
                        <path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"></path>
                        <line x1="6" y1="1" x2="6" y2="4"></line>
                        <line x1="10" y1="1" x2="10" y2="4"></line>
                        <line x1="14" y1="1" x2="14" y2="4"></line>
                    </svg>
                    <span>Find this useful? Buy me a coffee!</span>
                </a>
                <button type="button" class="btn btn-icon" id="help-btn" aria-label="Keyboard shortcuts" title="Keyboard shortcuts">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                        <line x1="12" y1="17" x2="12.01" y2="17"></line>
                    </svg>
                </button>
                <button type="button" class="btn btn-icon" id="settings-btn" aria-label="Settings">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="3"></circle>
                        <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"></path>
                    </svg>
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <main class="app-main">
            <!-- Controls Bar -->
            <div class="controls-bar">
                <!-- Year Navigation -->
                <nav class="year-nav" aria-label="Year navigation">
                    <button type="button" class="btn btn-nav" id="prev-year-btn" aria-label="Previous year">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="15 18 9 12 15 6"></polyline>
                        </svg>
                    </button>
                    <div class="year-display">
                        <span class="year-label" id="year-display">2025</span>
                    </div>
                    <button type="button" class="btn btn-nav" id="next-year-btn" aria-label="Next year">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="9 18 15 12 9 6"></polyline>
                        </svg>
                    </button>
                </nav>

                <!-- Region Selector -->
                <div class="region-selector">
                    <label for="region-select" class="region-label">Bank Holidays:</label>
                    <select id="region-select" class="region-select">
                        <option value="england">England & Wales</option>
                        <option value="scotland">Scotland</option>
                        <option value="northern-ireland">Northern Ireland</option>
                    </select>
                </div>
            </div>

            <!-- Leave Summary Bar -->
            <div class="leave-summary" id="leave-summary">
                <div class="leave-allowance">
                    <label for="leave-allowance-input" class="leave-allowance-label">Annual Leave:</label>
                    <input type="number" 
                           id="leave-allowance-input" 
                           class="leave-allowance-input" 
                           value="25" 
                           min="0" 
                           max="99"
                           aria-describedby="leave-allowance-desc">
                    <span class="leave-allowance-unit">days</span>
                </div>
                <div class="leave-counter" role="status" aria-live="polite" aria-label="Leave balance">
                    <div class="leave-counter-item leave-counter-item--booked">
                        <span class="leave-counter-value" id="leave-booked-count" aria-label="Days booked">0</span>
                        <span class="leave-counter-label">Booked</span>
                    </div>
                    <div class="leave-counter-divider" aria-hidden="true"></div>
                    <div class="leave-counter-item leave-counter-item--remaining">
                        <span class="leave-counter-value" id="leave-remaining-count" aria-label="Days remaining">25</span>
                        <span class="leave-counter-label">Remaining</span>
                    </div>
                </div>
                <div class="leave-progress" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" aria-label="Leave usage">
                    <div class="leave-progress-bar" id="leave-progress-bar" style="width: 0%"></div>
                </div>
            </div>

            <!-- Mode Toggle -->
            <div class="mode-toggle-container">
                <div class="mode-toggle" role="tablist" aria-label="Calendar mode">
                    <button type="button" 
                            class="mode-toggle-btn mode-toggle-btn--active" 
                            id="mode-school-holidays"
                            role="tab"
                            aria-selected="true"
                            aria-controls="calendar-container">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M22 10v6M2 10l10-5 10 5-10 5z"></path>
                            <path d="M6 12v5c3 3 9 3 12 0v-5"></path>
                        </svg>
                        <span>School Holidays</span>
                    </button>
                    <button type="button" 
                            class="mode-toggle-btn" 
                            id="mode-book-leave"
                            role="tab"
                            aria-selected="false"
                            aria-controls="calendar-container">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="16" y1="2" x2="16" y2="6"></line>
                            <line x1="8" y1="2" x2="8" y2="6"></line>
                            <line x1="3" y1="10" x2="21" y2="10"></line>
                            <path d="M9 16l2 2 4-4"></path>
                        </svg>
                        <span>Book Leave</span>
                    </button>
                    <button type="button" 
                            class="mode-toggle-btn" 
                            id="mode-block-days"
                            role="tab"
                            aria-selected="false"
                            aria-controls="calendar-container">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="4.93" y1="4.93" x2="19.07" y2="19.07"></line>
                        </svg>
                        <span>Block Days</span>
                    </button>
                    <button type="button" 
                            class="mode-toggle-btn" 
                            id="mode-partner-leave"
                            role="tab"
                            aria-selected="false"
                            aria-controls="calendar-container">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="9" cy="7" r="4"></circle>
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                        </svg>
                        <span>Partner's Leave</span>
                    </button>
                </div>
                <div class="mode-actions">
                    <button type="button" class="btn btn-text" id="clear-selection-btn">
                        Clear Selection
                    </button>
                    <button type="button" class="btn btn-secondary btn-sm" id="suggest-holidays-btn" hidden>
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83"></path>
                        </svg>
                        <span>Suggest Holidays</span>
                    </button>
                </div>
            </div>

            <!-- Mode Instructions -->
            <div class="mode-instructions" id="mode-instructions">
                <p class="instruction-text" id="instruction-text">
                    Click or drag to mark school holiday periods. These help you see when you need time off.
                </p>
            </div>

            <!-- Export Buttons (above calendar) -->
            <div class="export-bar">
                <button type="button" class="btn btn-secondary" id="export-print-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="6 9 6 2 18 2 18 9"></polyline>
                        <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
                        <rect x="6" y="14" width="12" height="8"></rect>
                    </svg>
                    <span>Print Summary</span>
                </button>
                <button type="button" class="btn btn-secondary btn-calendar-export" id="export-ical-btn">
                    <span class="calendar-logos">
                        <svg class="logo-google" viewBox="0 0 24 24" width="16" height="16">
                            <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                            <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                            <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                            <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                        </svg>
                        <svg class="logo-outlook" viewBox="0 0 32 32" width="16" height="16">
                            <defs><linearGradient id="outlookGrad" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" style="stop-color:#0078D4"/><stop offset="100%" style="stop-color:#28A8EA"/></linearGradient></defs>
                            <rect fill="url(#outlookGrad)" width="32" height="32" rx="6"/>
                            <ellipse cx="16" cy="16" rx="8" ry="9" fill="none" stroke="white" stroke-width="3"/>
                        </svg>
                    </span>
                    <span>Export to Calendar</span>
                </button>
                <button type="button" class="btn btn-primary" id="share-partner-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="18" cy="5" r="3"></circle>
                        <circle cx="6" cy="12" r="3"></circle>
                        <circle cx="18" cy="19" r="3"></circle>
                        <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
                        <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
                    </svg>
                    <span>Share with Partner</span>
                </button>
            </div>

            <!-- Calendar Legend -->
            <div class="calendar-legend" role="list" aria-label="Calendar colour key">
                <div class="legend-item" role="listitem">
                    <span class="legend-swatch legend-swatch--weekend" aria-hidden="true"></span>
                    <span class="legend-label">Weekend</span>
                </div>
                <div class="legend-item" role="listitem">
                    <span class="legend-swatch legend-swatch--bank-holiday" aria-hidden="true"></span>
                    <span class="legend-label">Bank Holiday</span>
                </div>
                <div class="legend-item" role="listitem">
                    <span class="legend-swatch legend-swatch--school-holiday" aria-hidden="true"></span>
                    <span class="legend-label">School Holiday</span>
                </div>
                <div class="legend-item" role="listitem">
                    <span class="legend-swatch legend-swatch--leave" aria-hidden="true"></span>
                    <span class="legend-label">Booked Leave</span>
                </div>
                <div class="legend-item" role="listitem">
                    <span class="legend-swatch legend-swatch--blocked" aria-hidden="true"></span>
                    <span class="legend-label">Non-bookable</span>
                </div>
                <div class="legend-item" role="listitem">
                    <span class="legend-swatch legend-swatch--today" aria-hidden="true"></span>
                    <span class="legend-label">Today</span>
                </div>
                <div class="legend-item" role="listitem">
                    <span class="legend-swatch legend-swatch--partner" aria-hidden="true"></span>
                    <span class="legend-label">Partner's Leave</span>
                </div>
            </div>

            <!-- Calendar Grid Container -->
            <div class="calendar-container" id="calendar-container" role="region" aria-label="12-month calendar" tabindex="-1">
                <!-- Calendar months will be rendered here by JavaScript -->
            </div>
        </main>

        <!-- Footer -->
        <footer class="app-footer">
            <p class="footer-text">
                All data stored locally in your browser. No cookies. No tracking.
                <a href="privacy.html" class="footer-link">Privacy Policy</a>
            </p>
            <p class="footer-version">v1.0.0</p>
        </footer>
    </div>

    <!-- Export Help Modal -->
    <div class="modal-overlay" id="export-help-modal" hidden>
        <div class="modal modal--export-help" role="dialog" aria-labelledby="export-help-title" aria-modal="true">
            <div class="modal-header">
                <h2 class="modal-title" id="export-help-title">Your Leave Calendar is Ready!</h2>
                <button type="button" class="btn btn-icon modal-close" id="export-help-close" aria-label="Close">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <p class="export-help-intro">
                    An <strong>.ics file</strong> has been downloaded. This is a universal calendar format that works with most calendar apps.
                </p>
                
                <div class="export-help-guides">
                    <div class="export-guide">
                        <div class="export-guide-header">
                            <svg class="logo-google" viewBox="0 0 24 24" width="24" height="24">
                                <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                                <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                                <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                                <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                            </svg>
                            <h3>Google Calendar</h3>
                        </div>
                        <ol class="export-guide-steps">
                            <li>Open <a href="https://calendar.google.com/calendar/r/settings/export" target="_blank" rel="noopener">Google Calendar Settings</a></li>
                            <li>Click "Import" in the left sidebar</li>
                            <li>Select the downloaded .ics file</li>
                            <li>Choose which calendar to add events to</li>
                            <li>Click "Import"</li>
                        </ol>
                    </div>
                    
                    <div class="export-guide">
                        <div class="export-guide-header">
                            <svg class="logo-outlook" viewBox="0 0 32 32" width="24" height="24">
                                <defs><linearGradient id="outlookGrad2" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" style="stop-color:#0078D4"/><stop offset="100%" style="stop-color:#28A8EA"/></linearGradient></defs>
                                <rect fill="url(#outlookGrad2)" width="32" height="32" rx="6"/>
                                <ellipse cx="16" cy="16" rx="8" ry="9" fill="none" stroke="white" stroke-width="3"/>
                            </svg>
                            <h3>Outlook</h3>
                        </div>
                        <ol class="export-guide-steps">
                            <li>Open the downloaded .ics file (double-click)</li>
                            <li>Outlook will open and show the events</li>
                            <li>Click "Import" or "Add to Calendar"</li>
                            <li>Or: Go to <a href="https://outlook.live.com/calendar" target="_blank" rel="noopener">Outlook Web</a> → Add calendar → Upload from file</li>
                        </ol>
                    </div>
                    
                    <div class="export-guide">
                        <div class="export-guide-header">
                            <svg viewBox="0 0 24 24" width="24" height="24">
                                <path fill="#000" d="M4 4h16v16H4V4zm2 2v12h12V6H6zm6 2a4 4 0 1 1 0 8 4 4 0 0 1 0-8z"/>
                            </svg>
                            <h3>Apple Calendar</h3>
                        </div>
                        <ol class="export-guide-steps">
                            <li>Double-click the downloaded .ics file</li>
                            <li>Apple Calendar will open automatically</li>
                            <li>Choose which calendar to add events to</li>
                            <li>Click "Add" or "OK"</li>
                        </ol>
                    </div>
                    
                    <div class="export-guide">
                        <div class="export-guide-header">
                            <svg viewBox="0 0 24 24" width="24" height="24">
                                <path fill="#000" d="M4 4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2H4zm0 2h16v2H4V6zm0 4h5v8H4v-8zm7 0h9v8h-9v-8z"/>
                            </svg>
                            <h3>Notion</h3>
                        </div>
                        <ol class="export-guide-steps">
                            <li>Create a Calendar database in Notion</li>
                            <li>Use a third-party tool like <a href="https://notion-automations.com" target="_blank" rel="noopener">Notion Automations</a></li>
                            <li>Or manually add each leave date to your database</li>
                        </ol>
                    </div>
                </div>
                
                <div class="export-help-support">
                    <p>Found this useful? <a href="https://paypal.me/viss23/5GBP" target="_blank" rel="noopener" class="support-link">Buy me a coffee</a> to help keep it free!</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Support Toast -->
    <div class="support-toast" id="support-toast" hidden>
        <div class="support-toast-content">
            <span class="support-toast-emoji">☕</span>
            <div class="support-toast-text">
                <strong>Glad you found this useful!</strong>
                <p>If you'd like to support this free tool...</p>
            </div>
            <a href="https://paypal.me/viss23/5GBP" target="_blank" rel="noopener" class="btn btn-coffee-toast">
                Buy me a coffee (£5)
            </a>
            <button type="button" class="support-toast-close" id="support-toast-close" aria-label="Close">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </div>
    </div>

    <!-- Share with Partner Modal -->
    <div class="modal-overlay" id="share-modal" hidden>
        <div class="modal modal--share" role="dialog" aria-labelledby="share-title" aria-modal="true">
            <div class="modal-header">
                <h2 class="modal-title" id="share-title">Share with Partner</h2>
                <button type="button" class="btn btn-icon modal-close" id="share-close" aria-label="Close share dialog">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <p class="share-intro">
                    Share your plan with your partner. This includes:
                </p>
                <ul class="share-stats-list">
                    <li><strong id="share-leave-count">0</strong> leave days (imported as "Partner's Leave")</li>
                    <li><strong id="share-school-count">0</strong> school holiday days (merged with their calendar)</li>
                </ul>
                
                <div class="setting-group">
                    <label for="partner-name-input" class="setting-label">Your Name</label>
                    <input type="text" 
                           id="partner-name-input" 
                           class="setting-input" 
                           placeholder="e.g., John" 
                           maxlength="30"
                           aria-describedby="name-hint">
                    <p class="setting-hint" id="name-hint">Helps your partner identify whose plan they're importing</p>
                </div>

                <div class="share-url-container" id="share-url-container">
                    <label class="setting-label">Share Link</label>
                    <div class="share-url-row">
                        <input type="text" 
                               id="share-url-output" 
                               class="share-url-input" 
                               readonly 
                               aria-label="Shareable URL">
                        <button type="button" class="btn btn-primary btn-lg" id="copy-url-btn">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                            </svg>
                            <span>Copy Link</span>
                        </button>
                    </div>
                    <p class="share-url-copied" id="share-url-copied" hidden>Link copied to clipboard!</p>
                </div>

                <div class="share-info">
                    <div class="share-info-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="12" y1="16" x2="12" y2="12"></line>
                            <line x1="12" y1="8" x2="12.01" y2="8"></line>
                        </svg>
                    </div>
                    <div class="share-info-content">
                        <strong>How it works:</strong> Your partner opens this link and clicks "Import". Your leave days will appear in their calendar under "Partner's Leave". They can then share their link back to you!
                    </div>
                </div>
                
                <div class="share-support">
                    <p>Found this useful? <a href="https://paypal.me/viss23/5GBP" target="_blank" rel="noopener" class="support-link">Buy me a coffee</a> to help keep it free!</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Import Partner Data Modal -->
    <div class="modal-overlay" id="import-partner-modal" hidden>
        <div class="modal modal--import" role="dialog" aria-labelledby="import-title" aria-modal="true">
            <div class="modal-header">
                <h2 class="modal-title" id="import-title">Import Partner's Leave</h2>
                <button type="button" class="btn btn-icon modal-close" id="import-close" aria-label="Close import dialog">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <p class="import-intro" id="import-intro">
                    <strong id="import-partner-name">Your partner</strong> has shared their plan with you.
                </p>
                
                <div class="import-summary" id="import-summary">
                    <ul class="import-stats-list">
                        <li><strong id="import-leave-count">0</strong> leave days → added as "Partner's Leave"</li>
                        <li><strong id="import-school-count">0</strong> school holidays → merged with your calendar</li>
                    </ul>
                </div>

                <div class="import-actions">
                    <button type="button" class="btn btn-primary btn-lg" id="import-accept-btn">
                        Import Plan
                    </button>
                    <button type="button" class="btn btn-secondary" id="import-skip-btn">
                        Skip
                    </button>
                </div>
                
                <p class="import-hint">
                    Partner's leave days will appear in purple on your calendar. School holidays will be merged with any you've already marked.
                </p>
            </div>
        </div>
    </div>

    <!-- Keyboard Shortcuts Modal -->
    <div class="modal-overlay" id="help-modal" hidden>
        <div class="modal" role="dialog" aria-labelledby="help-title" aria-modal="true">
            <div class="modal-header">
                <h2 class="modal-title" id="help-title">Keyboard Shortcuts</h2>
                <button type="button" class="btn btn-icon modal-close" id="help-close" aria-label="Close help">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="shortcuts-grid">
                    <div class="shortcut-section">
                        <h3 class="shortcut-section-title">Navigation</h3>
                        <div class="shortcut-item">
                            <kbd class="kbd">Ctrl/Cmd</kbd> + <kbd class="kbd">←</kbd>
                            <span class="shortcut-desc">Previous year</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd class="kbd">Ctrl/Cmd</kbd> + <kbd class="kbd">→</kbd>
                            <span class="shortcut-desc">Next year</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd class="kbd">Tab</kbd>
                            <span class="shortcut-desc">Navigate between controls</span>
                        </div>
                    </div>

                    <div class="shortcut-section">
                        <h3 class="shortcut-section-title">Modes</h3>
                        <div class="shortcut-item">
                            <kbd class="kbd">Alt</kbd> + <kbd class="kbd">1</kbd>
                            <span class="shortcut-desc">School Holidays mode</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd class="kbd">Alt</kbd> + <kbd class="kbd">2</kbd>
                            <span class="shortcut-desc">Book Leave mode</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd class="kbd">Alt</kbd> + <kbd class="kbd">3</kbd>
                            <span class="shortcut-desc">Block Days mode</span>
                        </div>
                    </div>

                    <div class="shortcut-section">
                        <h3 class="shortcut-section-title">Calendar Actions</h3>
                        <div class="shortcut-item">
                            <kbd class="kbd">Enter</kbd> or <kbd class="kbd">Space</kbd>
                            <span class="shortcut-desc">Select/deselect focused day</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd class="kbd">Click + Drag</kbd>
                            <span class="shortcut-desc">Select date range</span>
                        </div>
                    </div>

                    <div class="shortcut-section">
                        <h3 class="shortcut-section-title">General</h3>
                        <div class="shortcut-item">
                            <kbd class="kbd">Esc</kbd>
                            <span class="shortcut-desc">Close modal</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd class="kbd">?</kbd>
                            <span class="shortcut-desc">Show this help</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal-overlay" id="settings-modal" hidden>
        <div class="modal" role="dialog" aria-labelledby="settings-title" aria-modal="true">
            <div class="modal-header">
                <h2 class="modal-title" id="settings-title">Settings</h2>
                <button type="button" class="btn btn-icon modal-close" id="settings-close" aria-label="Close settings">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <!-- Leave Year Start -->
                <div class="setting-group">
                    <label for="year-start-select" class="setting-label">Leave Year Starts:</label>
                    <select id="year-start-select" class="setting-select">
                        <option value="0">January</option>
                        <option value="1">February</option>
                        <option value="2">March</option>
                        <option value="3">April</option>
                        <option value="4">May</option>
                        <option value="5">June</option>
                        <option value="6">July</option>
                        <option value="7">August</option>
                        <option value="8">September</option>
                        <option value="9">October</option>
                        <option value="10">November</option>
                        <option value="11">December</option>
                    </select>
                    <p class="setting-hint">Set when your annual leave year begins (e.g., April for UK financial year)</p>
                </div>

                <!-- Data Management -->
                <div class="setting-group setting-group--actions">
                    <h3 class="setting-group-title">Data Management</h3>
                    <div class="setting-actions">
                        <button type="button" class="btn btn-secondary" id="export-data-btn">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="7 10 12 15 17 10"></polyline>
                                <line x1="12" y1="15" x2="12" y2="3"></line>
                            </svg>
                            <span>Export Data</span>
                        </button>
                        <button type="button" class="btn btn-secondary" id="import-data-btn">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="17 8 12 3 7 8"></polyline>
                                <line x1="12" y1="3" x2="12" y2="15"></line>
                            </svg>
                            <span>Import Data</span>
                        </button>
                        <input type="file" id="import-file-input" accept=".json" hidden>
                    </div>
                    <button type="button" class="btn btn-danger" id="clear-all-data-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="3 6 5 6 21 6"></polyline>
                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                        </svg>
                        <span>Clear All Data</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Suggest School Holidays Modal -->
    <div class="modal-overlay" id="suggest-holidays-modal" hidden>
        <div class="modal modal--suggest" role="dialog" aria-labelledby="suggest-title" aria-modal="true">
            <div class="modal-header">
                <h2 class="modal-title" id="suggest-title">Suggest School Holidays</h2>
                <button type="button" class="btn btn-icon modal-close" id="suggest-close" aria-label="Close">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <p class="suggest-intro">
                    Generate typical UK school holiday dates based on common patterns. You can adjust them after applying.
                </p>
                
                <div class="suggest-form">
                    <div class="setting-group">
                        <label for="suggest-year" class="setting-label">Academic Year</label>
                        <select id="suggest-year" class="setting-select">
                            <!-- Options populated by JavaScript -->
                        </select>
                    </div>
                    
                    <div class="setting-group">
                        <label for="suggest-region" class="setting-label">Region</label>
                        <select id="suggest-region" class="setting-select">
                            <option value="england">England & Wales</option>
                            <option value="scotland">Scotland</option>
                            <option value="northern-ireland">Northern Ireland</option>
                        </select>
                    </div>
                </div>

                <div class="suggest-warning">
                    <div class="suggest-warning-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                            <line x1="12" y1="9" x2="12" y2="13"></line>
                            <line x1="12" y1="17" x2="12.01" y2="17"></line>
                        </svg>
                    </div>
                    <div class="suggest-warning-text">
                        <strong>These are estimates</strong> based on typical patterns. Actual dates vary by Local Authority. 
                        <a href="https://www.gov.uk/school-term-holiday-dates" target="_blank" rel="noopener">Check your council's official dates</a>.
                    </div>
                </div>

                <div class="suggest-preview" id="suggest-preview">
                    <h3 class="suggest-preview-title">Preview</h3>
                    <ul class="suggest-preview-list" id="suggest-preview-list">
                        <!-- Populated by JavaScript -->
                    </ul>
                    <p class="suggest-preview-total" id="suggest-preview-total"></p>
                </div>

                <div class="suggest-actions">
                    <button type="button" class="btn btn-text" id="suggest-cancel">Cancel</button>
                    <button type="button" class="btn btn-primary" id="suggest-apply">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="20 6 9 17 4 12"></polyline>
                        </svg>
                        <span>Apply to Calendar</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Print Preview Container (hidden, used for generating print content) -->
    <div id="print-container" class="print-container"></div>

    <!-- LZString for URL compression (MIT License) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lz-string/1.5.0/lz-string.min.js"></script>
    
    <!-- Scripts -->
    <script src="src/js/utils.js"></script>
    <script src="src/js/storage.js"></script>
    <script src="src/js/bankHolidays.js"></script>
    <script src="src/js/schoolHolidayPatterns.js"></script>
    <script src="src/js/calendar.js"></script>
    <script src="src/js/export.js"></script>
    <script src="src/js/partner.js"></script>
    <script src="src/js/app.js"></script>
</body>
</html>

